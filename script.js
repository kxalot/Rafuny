const challenges = {1: ['Bésale el cuello durante 2 minutos sin parar.', 'Lame muy lentamente su ombligo.', 'Quita una prenda con los dientes.', 'Realiza un baile sexy mientras te vas desnudando.', 'Chupa lentamente un dedo de su pie.', 'Acaricia sus genitales por encima de la ropa durante 1 minuto.', 'Simula una mamada o lamida con la ropa puesta.', 'Mastúrbate suavemente frente a tu pareja sin tocarte los genitales.', 'Sube una pierna tuya sobre su cuerpo y muévete sensualmente.', 'Ponle una prenda tuya interior (bragas o calzoncillo) sobre la cabeza o cuello.', 'Siéntate sobre su cara sin contacto real (a 1 cm).', 'Lame su oreja de forma muy provocativa.', 'Usa un hielo para pasar por su vientre y muslos.', 'Acaricia su trasero por encima de la ropa con ambas manos.', 'Hazle un masaje sensual en los muslos internos.', 'Frota tus pezones contra alguna parte de su cuerpo.', 'Cruza las piernas sobre su torso como si le fueras a atrapar.', 'Sácale la lengua y úsala para tentarle a distancia.', 'Siéntate encima en ropa interior y muévete lentamente.', 'Ponte un disfraz sexy y aparece como si nada.'], 2: ['Chupa un dedo del pie lentamente y mírale a los ojos.', 'Ponle nata/chocolate en una parte del cuerpo y límpiala con la lengua.', 'Bebe una bebida con alcohol de su ombligo.', 'Lame sus testículos sin usar las manos.', 'Da un mordisco suave en la parte interna del muslo.', 'Hazle sexo oral sin que acabe durante 2 minutos.', 'Introduce un dedo en su boca y dile que lo chupe.', 'Dale un azote con la mano en el trasero.', 'Usa un objeto del entorno como vibrador (cepillo eléctrico, mango de cuchara...).', 'Dale un beso profundo en el ano.', 'Desliza cubitos de hielo por sus pezones.', 'Simula penetración con un objeto no sexual.', 'Usa el palo de crucifixión para inmovilizarle las piernas.', 'Hazle lamer algo dulce de tus pezones.', 'Métete un dedo en el ano y juega con él suavemente mientras le miras.', 'Lame cada uno de sus dedos de los pies.', 'Chupa los pezones mientras le acaricias entre las piernas.', 'Mastúrbale mientras le das alcohol en la boca.', 'Métete hielo en la boca y hazle sexo oral sin sacarlo.', 'Pásale un consolador por la cara lentamente sin dejarle tocarlo.'], 3: ['Átale las manos con cuerda y juega con sus pezones.', 'Mastúrbale mientras llevas un disfraz de dominatrix.', 'Ponle el tentáculo vibrador entre los muslos sin meterlo.', 'Dale azotes con la fusta mientras se toca.', 'Lame todas las partes de su cuerpo sin hablar.', 'Ponle una mordaza y acaríciale el ano.', 'Haz que se quede de rodillas mientras le acaricias suavemente los genitales.', 'Lame su trasero sin usar las manos.', 'Juega con su ano con un dedo, sin llegar a penetrar.', 'Sujétale del gancho del techo y bésale el pecho.', 'Hazle chupar el tentáculo como si fuera real.', 'Realiza una felación mientras está con los ojos vendados.', 'Cógelo de las caderas y simula una cabalgada sin ropa.', 'Hazle un masaje con aceite caliente por todo el cuerpo.', 'Dale a elegir entre tentáculo o vibrador... y úsalo en él/ella.', 'Lame sus pies mientras se masturba.', 'Saca la lengua y juega con su ano sin tocar con las manos.', 'Atado y de pie: dale caricias suaves con un pañuelo.', 'Mueve tus genitales por su cara sin permitirle tocar.', 'Usa el palo para inmovilizarle los brazos, y empieza a lamerle el torso lentamente.', 'Ponte el disfraz de colegiala y actúa sumisa mientras él/ella manda.', 'Ata los testículos con una cuerda y juega con ellos con la lengua.', 'Usa la fusta con golpes suaves sobre los genitales (sin pasarse).', 'Escribe palabras sexuales sobre su cuerpo con pintalabios.', 'Escupe en sus genitales y extiéndelo con la mano.', 'Esconde el vibrador dentro de tu ropa interior y haz que lo busque sin manos.', 'Haz una "cata" de su cuerpo: ojos vendados, debes adivinar con la lengua qué zona es.', 'Simula meter la mano entera entre las piernas usando solo los nudillos como presión.', 'Hazle tocarte con la nariz cada parte de tu cuerpo, sin usar manos.', 'Usa el palo para inmovilizarle boca abajo, y lame desde nuca a talón.'], 4: ['Amárrale de pies y manos con el palo y usa el gancho para suspender.', 'Ponle la mordaza y hazle sexo oral hasta el borde del orgasmo... y para.', 'Ordénale masturbarse mirándote a los ojos mientras le azotas con la fusta.', 'Estimula el ano con el tentáculo.', 'Mastúrbale con el vibrador hasta que no aguante más.', 'Azótale hasta que diga tu nombre 3 veces.', 'Obligación: no puede correrse hasta que tú se lo permitas.', 'Crea una escena de dominación completa con tu disfraz favorito.', 'Chúpale lentamente todo el cuerpo sin dejarle moverse.', 'Siéntate sobre su cara con fuerza y dale órdenes.', 'Introduce el consolador y estimula con vibrador a la vez.', 'Mastúrbale atado con los ojos vendados.', 'Simula que eres otra persona y actúa diferente.', 'Hazle correrse con una sola mano y nada más.', 'Lame su ano mientras usas el vibrador sobre sus genitales.', 'Métete dos dedos en el ano mientras usas juguetes en tu pareja.', 'Hazle llorar de placer (literalmente, haz que se deshaga).', 'Mastúrbate sobre él/ella mientras está amarrado/a.', 'Usa el tentáculo como látigo y después introdúcelo.', 'Oblígale a correrse... y luego a seguir.', 'Escúpale en la cara y dile que no se limpie hasta que tú lo hagas.', 'Oblígale a chuparte después de correrte.', 'Mete la mano entera (o simúlalo de forma profunda) en su ano/vulva usando lubricante y guantes.', 'Llena la vulva/ano con lubricante hasta que chorree.', 'Ata sus testículos al palo y hazle estirar hacia ti.', 'Píntale el cuerpo entero con palabras como "puta", "sucio", "mío"... y hazle repetirlo.', 'Sujétale al gancho, de espaldas, y juega con todos los juguetes sin avisar qué usarás.', 'Penetra su ano o vagina mientras está amordazado y completamente inmovilizado.', 'Mastúrbate sobre su cara mientras no puede moverse.', 'Hazle lamer tus pies, luego tus genitales, luego el suelo.']};

let state = {
    players: [],
    genders: [],
    mode: "rapido",
    level: 1,
    turn: 0,
    maxPerLevel: 5,
    history: {},
};

function startGame() {
    const p1 = document.getElementById("player1").value.trim();
    const g1 = document.getElementById("gender1").value;
    const p2 = document.getElementById("player2").value.trim();
    const g2 = document.getElementById("gender2").value;
    const mode = document.querySelector("input[name='mode']:checked").value;

    if (!p1 || !p2) return alert("Introduce ambos nombres.");

    state.players = [p1, p2];
    state.genders = [g1, g2];
    state.mode = mode;
    state.level = 1;
    state.turn = 0;
    state.maxPerLevel = mode === "lento" ? 10 : 5;
    state.history = {};

    document.getElementById("setup").classList.add("hidden");
    document.getElementById("game").classList.remove("hidden");

    nextChallenge();
}

function nextChallenge() {
    const level = state.level;
    if (!state.history[level]) state.history[level] = [];

    const pool = challenges[level].filter(c => !state.history[level].includes(c));
    if (pool.length === 0) {
        state.level++;
        if (!challenges[state.level]) {
            alert("¡Has completado el castillo!");
            return resetGame();
        }
        return nextChallenge();
    }

    const challenge = pool[Math.floor(Math.random() * pool.length)];
    state.history[level].push(challenge);

    const playerIndex = state.turn % 2;
    const name = state.players[playerIndex];

    document.getElementById("turnTitle").innerText = "Turno de...";
    document.getElementById("levelText").innerText = "Nivel " + level;
    document.getElementById("playerTurnText").innerText = "Turno de " + name;
    document.getElementById("challengeText").innerText = challenge;

    state.turn++;
}

function resetGame() {
    location.reload();
}
